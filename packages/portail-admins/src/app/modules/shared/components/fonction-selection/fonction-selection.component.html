<div class="row mb-5">
  <div
    [class.fr-input-group--error]="
      fonctionFormControl &&
      (submitted || fonctionFormControl?.dirty) &&
      fonctionFormControl.errors
    "
    class="col-6 fr-input-group col-md-6"
  >
    <ng-container>
      <label class="fr-label" for="fonction">{{ label }}</label>
      <select
        id="fonction"
        [(ngModel)]="fonction"
        (ngModelChange)="onModelChange(CONTROL_OPTIONS.FONCTION, $event)"
        name="fonction"
        [ngClass]="{
          'is-invalid':
            fonctionFormControl &&
            (submitted || fonctionFormControl?.dirty) &&
            fonctionFormControl.errors
        }"
        class="fr-select"
        [attr.required]="required"
      >
        <option [ngValue]="null">Sélectionnez une option</option>
        <option
          *ngFor="let option of USER_FONCTION | keyvalue : compareOriginalOrder"
          [value]="option.key"
        >
          {{ USER_FONCTION_LABELS[option.value] }}
        </option>
      </select>
      <div
        *ngIf="
          (submitted || fonctionFormControl?.dirty) &&
          fonctionFormControl?.errors
        "
        class="fr-messages-group"
        id="responsable-fonction-errors"
        aria-live="polite"
      >
        <p class="fr-message fr-message--error">
          {{ invalidFeedbackText }}
        </p>
      </div>
    </ng-container>
    <small id="responsable-fonction-description"
      >Président.e, Directrice, etc.</small
    >
  </div>

  <div class="col-6 fr-input-group required col-md-6">
    <div class="col-12" *ngIf="fonction === USER_FONCTION.AUTRE">
      <label
        class="fr-label"
        for="fonctionDetail"
        [class.visually-hidden]="!displayLabel"
        >Préciser la fonction occupée par l’utilisateur</label
      >
      <input
        [(ngModel)]="fonctionDetail"
        (ngModelChange)="onModelChange(CONTROL_OPTIONS.DETAIL_FONCTION, $event)"
        type="text"
        class="fr-input"
        id="fonctionDetail"
        maxlength="200"
        name="fonctionDetail"
        [ngClass]="{
          'is-invalid':
            (fonctionDetailFormControl.dirty || submitted) &&
            fonctionDetailFormControl.errors
        }"
        [attr.aria-invalid]="
          (fonctionDetailFormControl.dirty || submitted) &&
          fonctionDetailFormControl.errors
            ? true
            : false
        "
        [attr.aria-describedby]="
          (fonctionDetailFormControl.dirty || submitted) &&
          fonctionDetailFormControl.errors
            ? 'fonction-error'
            : 'fonction-detail-description'
        "
        required
      />
      <div
        *ngIf="submitted && fonctionDetailFormControl?.errors"
        class="fr-messages-group"
        id="responsable-detail-fonction-errors"
        aria-live="polite"
      >
        <p class="fr-message fr-message--error">
          Veuillez préciser la fonction occupée par l’utilisateur
        </p>
      </div>
    </div>
  </div>
</div>
