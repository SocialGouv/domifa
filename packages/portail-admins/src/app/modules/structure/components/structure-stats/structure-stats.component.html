<div class="row mt-2 gap-2 align-items-end" *ngIf="structure">
  <div class="fr-select-group col-7 mb-0">
    <label class="fr-label mb-0" for="year"> Selectionner un année </label>
    <select
      [disabled]="loading || structure.statut === 'REFUS'"
      id="year"
      class="fr-select"
      [(ngModel)]="metabaseParams.year"
      (ngModelChange)="getMetabaseUrl()"
      name="year"
    >
      <option [value]="null"></option>
      <option *ngFor="let year of years" [value]="year">
        {{ year }}
      </option>
    </select>
  </div>
  <button
    (click)="getMetabaseUrl()"
    [disabled]="loading || structure.statut === 'REFUS'"
    [attr.aria-busy]="loading"
    type="button"
    class="fr-btn fr-icon-refresh-line fr-btn--icon-right fr-btn--secondary"
  >
    <span *ngIf="loading">
      <fa-icon
        [icon]="['fas', 'circle-notch']"
        aria-hidden="true"
        animation="spin"
      >
      </fa-icon>
      Veuillez patienter...
    </span>
    <span *ngIf="!loading">Rafraîchir les données </span>
  </button>
  <button
    (click)="export()"
    [disabled]="loading || structure.statut === 'REFUS'"
    [attr.aria-busy]="loading"
    type="button"
    class="fr-btn fr-icon-download-line fr-btn--icon-right fr-btn--secondary"
  >
    <span *ngIf="loading"> Veuillez patienter... </span>
    <span *ngIf="!loading">Exporter le rapport </span>
  </button>
</div>
<div *ngIf="structure.statut === 'REFUS'" class="fr-callout mt-5">
  <p class="fr-callout--text">Statistiques indisponible</p>
</div>
<div *ngIf="iframeUrl && structure.statut !== 'REFUS'">
  <iframe
    title="Rapports d'activité"
    [src]="iframeUrl"
    width="100%"
    height="4000"
  ></iframe>
</div>
