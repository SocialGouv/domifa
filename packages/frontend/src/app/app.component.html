<nav class="navbar navbar-expand-lg">
  <a class="navbar-brand" routerLink="/">
    <img src="../assets/images/logo.png" alt="Logo Domifa" />
    <span id="nom-asso" *ngIf="me">
      {{ me.structure.nom }}
    </span>
  </a>
  <button
    class="navbar-toggler hidden-sm-up"
    type="button"
    (click)="isNavbarCollapsed = !isNavbarCollapsed"
    data-target="#navbarsDefault"
    aria-controls="navbarsDefault"
    aria-expanded="false"
    aria-label="Toggle navigation"
  >
    <span class="navbar-toggler-icon"></span>
  </button>
  <div
    [ngbCollapse]="isNavbarCollapsed"
    class="collapse navbar-collapse"
    id="navbarsDefault"
  >
    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
      <li class="nav-item active"></li>
    </ul>
    <div class="my-2 my-lg-0">
      <ng-container *ngIf="!me">
        <a routerLink="/inscription" class="btn btn-outline-primary">
          S'inscrire
        </a>
        <a
          routerLink="/connexion"
          aria-hidden="true"
          title="Se connecter"
          class="btn btn-outline-primary"
        >
          Se connecter
        </a>
      </ng-container>

      <ng-container *ngIf="me">
        <a
          routerLink="/manage"
          aria-hidden="true"
          title="Liste des usagers"
          class="btn btn-outline-primary"
        >
          Liste des usagers
        </a>
        <a
          *ngIf="me.role !== 'facteur'"
          routerLink="/nouveau"
          class="btn btn-outline-secondary"
        >
          <fa-icon icon="plus" class="btn-icon"></fa-icon>
          Cr√©er une demande
        </a>

        <a
          *ngIf="me.role !== 'facteur'"
          routerLink="/import"
          class="btn btn-primary"
        >
          <fa-icon aria-hidden="true" title="Importer" icon="upload"></fa-icon>
        </a>

        <div
          ngbDropdown
          id="dropdownBasic1"
          display="dynamic"
          placement="bottom-right"
          class="d-inline-block"
        >
          <button class="btn btn-outline-primary" ngbDropdownToggle>
            <fa-icon aria-hidden="true" title="Compte" icon="user"></fa-icon>
          </button>
          <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
            <a ngbDropdownItem routerLink="/mon-compte">
              <fa-icon aria-hidden="true" title="Compte" icon="user"></fa-icon>
              Compte</a
            >
            <a
              ngbDropdownItem
              *ngIf="me.role === 'admin' || me.role === 'responsable'"
              routerLink="/admin"
            >
              <fa-icon
                aria-hidden="true"
                title="Administration"
                icon="users"
              ></fa-icon>
              Utilisateurs</a
            >
            <a
              ngbDropdownItem
              *ngIf="me.role === 'admin' || me.role === 'responsable'"
              routerLink="/structure-edit"
            >
              <fa-icon
                aria-hidden="true"
                title="Structure"
                icon="home"
              ></fa-icon>
              Structure</a
            >
            <a
              ngbDropdownItem
              *ngIf="me.role === 'admin' && me.structure?.sms?.enabledByDomifa"
              routerLink="/structures/sms"
            >
              <fa-icon
                aria-hidden="true"
                title="Notifications"
                icon="sms"
              ></fa-icon>
              Notifications</a
            >
            <a
              ngbDropdownItem
              *ngIf="
                me.role === 'admin' ||
                me.role === 'responsable' ||
                me.role === 'simple'
              "
              routerLink="/rapport-activite"
            >
              <fa-icon
                aria-hidden="true"
                title="Statistiques"
                icon="chart-bar"
              ></fa-icon>
              Statistiques</a
            >
            <a ngbDropdownItem (click)="logout()">
              <fa-icon
                aria-hidden="true"
                title="Statistiques"
                icon="sign-out-alt"
              ></fa-icon>
              D√©connexion
            </a>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</nav>
<div id="page">
  <router-outlet></router-outlet>
</div>
<div class="not-print" id="help-button-wrapper">
  <button id="help-button" (click)="openModal(helpCenter)">
    <fa-icon icon="question"></fa-icon>
  </button>
</div>

<div class="not-print" id="matomo-info" *ngIf="!matomoInfo">
  <div>
    Nous collectons des donn√©es anonymis√©es √† des fins statistiques via l'outil
    fran√ßais Matomo. Pour tout savoir sur notre utilisation des donn√©es,
    consultez notre
    <a [routerLink]="['/confidentialite']" routerLinkActive="router-link-active"
      >politique de confidentialit√©.</a
    >
  </div>
  <div>
    <button
      type="button"
      class="btn btn-white"
      aria-label="Fermer le message"
      (click)="closeMatomo()"
    >
      Fermer <span aria-hidden="true">&times;</span>
    </button>
  </div>
</div>

<ng-template #maintenanceModal let-modal>
  <div class="modal-body text-center">
    <h4 class="modal-title">‚ö†Ô∏è Maintenance en cours de Domifa ‚ö†Ô∏è</h4>
    <br />
    Veuillez nous excuser pour la g√™ne occasionn√©e.
    <br />
    Vous pourrez de nouveau utiliser Domifa dans quelques minutes.

    <br /><br />

    Cette fen√™tre disparaitra d√®s la fin de la maintenance.
    <br />
    <br />
  </div>
</ng-template>

<ng-template #versionModal let-modal>
  <div class="modal-body text-center">
    <h4 class="modal-title">
      ‚ÑπÔ∏è Une nouvelle version de Domifa est disponible
    </h4>
    <br />
    Afin de profiter des nouveaut√©s de Domifa, vous devez actualiser la page.
    <br /><br />
    <button class="btn btn-primary" (click)="refresh()">
      <fa-icon icon="sync"></fa-icon> Actualiser
    </button>

    <br />
    <br />
  </div>
</ng-template>

<ng-template #newsCenter let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">
      üéâ Les derni√®res nouveaut√©s de Domifa üéâ
    </h4>
    <button
      type="button"
      class="close"
      aria-label="Fermer la fen√™tre"
      (click)="closeNewsModal()"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body text-center">
    <div class="text-left">
      <p>
        <b>
          {{ domifaNews.date | date: "dd/MM/yyyy" }}
        </b>
        <span *ngIf="domifaNews.description"
          >- {{ domifaNews.description }}</span
        >
      </p>
      <div *ngFor="let content of domifaNews.content" class="text-left news">
        <span
          class="badge badge-pill"
          [ngClass]="{
            'badge-primary': content.type === 'new',
            'badge-warning': content.type === 'bug'
          }"
        >
          {{ newsLabels[content.type] }}
        </span>
        &nbsp;
        <b>{{ content.categorie }}</b>
        <br />
        <ul>
          <li *ngFor="let message of content.message">{{ message }}</li>
        </ul>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn btn-primary" (click)="closeNewsModal()">
      Continuer sur Domifa
    </button>
  </div>
</ng-template>

<ng-template #helpCenter let-modal>
  <div class="modal-header">
    <h4 class="modal-title">Centre d'aide Domifa</h4>
    <button
      type="button"
      class="close"
      aria-label="Fermer la fen√™tre"
      (click)="closeHelpModal()"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body text-center">
    <p>Notre guide d'utilisateur peut vous accompagner :</p>

    <a
      href="/assets/files/guide_utilisateur_domifa.pdf"
      target="_blank"
      class="btn btn-primary"
      download
      ><fa-icon icon="download"></fa-icon>
      T√©l√©charger notre guide utilisateur
    </a>
    <br /><br />
    <p>Vous vous posez une question ?</p>
    <a
      [routerLink]="['/faq']"
      class="btn btn-primary"
      routerLinkActive="router-link-active"
      title=""
    >
      Consultez notre FAQ </a
    ><br />

    <br />
    <span>Contactez-nous :</span>
    <br />
    <br />
    <a target="_blank" href="mailto:contact.domifa@fabrique.social.gouv.fr">
      <b> contact.domifa[at]fabrique.social.gouv.fr </b>
    </a>
    <br />
  </div>
</ng-template>

<footer class="not-print page-footer">
  <div>
    <img
      src="../assets/images/logoministere.svg"
      alt="Logo Domifa"
      title="Logo Domifa"
    />
    <br />
    <span class="small">¬© 2020 Fabrique des Minist√®res Sociaux</span>
    <br />
  </div>
  <div>
    <a
      [routerLink]="['/news']"
      routerLinkActive="router-link-active"
      title="Nouveaut√©s"
    >
      Nouveaut√©s
    </a>
  </div>
  <div>
    <a
      [routerLink]="['/faq']"
      routerLinkActive="router-link-active"
      title="FAQ"
    >
      FAQ
    </a>
  </div>
  <div>
    <a
      [routerLink]="['/cgu']"
      routerLinkActive="router-link-active"
      title="Conditions d'utilisation"
    >
      Conditions d'utilisation
    </a>
  </div>
  <div>
    <a
      [routerLink]="['/mentions-legales']"
      routerLinkActive="router-link-active"
    >
      Mentions l√©gales
    </a>
  </div>
  <div>
    <a
      [routerLink]="['/confidentialite']"
      routerLinkActive="router-link-active"
    >
      Politique de confidentialit√©
    </a>
  </div>
  <div>
    <a
      href="https://voxusagers.numerique.gouv.fr/Demarches/2495?&view-mode=formulaire-avis&nd_mode=en-ligne-enti%C3%A8rement&nd_source=button&key=7b9d610111ea41e1af555b1343146d12"
    >
      <img
        src="https://voxusagers.numerique.gouv.fr/static/bouton-blanc.svg"
        alt="Je donne mon avis"
        title="Je donne mon avis sur cette d√©marche"
      />
    </a>
  </div>
</footer>

<app-loading></app-loading>
