<ng-container>
  <label for="fonction">{{ label }}</label>
  <select
    id="fonction"
    [(ngModel)]="fonction"
    (ngModelChange)="onModelChange('fonction', $event)"
    name="fonction"
    [ngClass]="{
      'is-invalid':
        fonctionFormControl &&
        (submitted || fonctionFormControl?.dirty) &&
        fonctionFormControl.errors
    }"
    class="form-select"
    [attr.required]="required"
  >
    <option [ngValue]="null">Sélectionnez une option</option>
    <option
      *ngFor="
        let option of USER_FONCTION_LABELS | keyvalue : compareOriginalOrder
      "
      [value]="option.value"
    >
      {{ option.value }}
    </option>
  </select>
  <p
    *ngIf="
      (submitted || fonctionFormControl?.dirty) && fonctionFormControl?.errors
    "
    class="invalid-feedback"
    id="responsable-fonction-errors"
  >
    {{ invalidFeedbackText }}
  </p>
</ng-container>
<small id="responsable-fonction-description"
  >Président.e, Directrice, etc.</small
>
<ng-container *ngIf="fonction === 'Autre' && fonctionFormControl">
  <div class="col-12 mt-2 form-group required">
    <label for="detailFonction" [class]="displayLabel ? '' : 'visually-hidden'"
      >Préciser</label
    >
    <input
      [(ngModel)]="detailFonction"
      (ngModelChange)="onModelChange('detailFonction', $event)"
      type="text"
      class="form-control"
      id="detailFonction"
      maxlength="200"
      name="detailFonction"
      [ngClass]="{
        'is-invalid':
          (detailFonctionFormControl?.dirty || submitted) &&
          detailFonctionFormControl?.errors
      }"
      [attr.aria-invalid]="
        (detailFonctionFormControl?.dirty || submitted) &&
        detailFonctionFormControl?.errors
          ? true
          : false
      "
      [attr.aria-describedby]="
        (detailFonctionFormControl?.dirty || submitted) &&
        detailFonctionFormControl?.errors
          ? 'fonction-error'
          : 'fonction-detail-description'
      "
      required
    />
    <p
      *ngIf="
        (submitted || detailFonctionFormControl?.dirty) &&
        detailFonctionFormControl?.errors
      "
      class="invalid-feedback"
      id="responsable-detail-fonction-errors"
    >
      Veuillez préciser la fonction
    </p>
  </div>
</ng-container>
