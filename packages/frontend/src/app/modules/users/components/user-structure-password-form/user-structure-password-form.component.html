<div class="row align-items-start py-2" *ngIf="parentFormGroup">
  <div class="col-md-6 col-12 fr-password required">
    <label class="fr-password__label fr-label" for="password"
      >Mot de passe</label
    >
    <div class="fr-input-wrap">
      <input
        (ngModelChange)="setPassword($event)"
        [(ngModel)]="password"
        name="password"
        [type]="!hidePassword ? 'text' : 'password'"
        class="fr-password__input fr-input"
        id="password"
        [ngClass]="{
          'is-invalid':
            (submitted || parentFormGroup.controls.password.dirty) &&
            parentFormGroup.controls.password.errors,
          'is-valid':
            parentFormGroup.controls.password.dirty &&
            !parentFormGroup.controls.password.errors
        }"
        aria-describedby="invalid-password"
        [attr.aria-invalid]="
          (submitted || parentFormGroup.controls.password.dirty) &&
          parentFormGroup.controls.password.errors
            ? true
            : false
        "
        autocomplete="new-password"
        required
      />
    </div>
    <div class="fr-messages-group" id="invalid-password">
      <p
        [ngClass]="
          parentFormGroup.controls.password?.errors?.required ||
          parentFormGroup.controls.password?.errors?.hasNumber
            ? 'fr-message--error'
            : 'fr-message--valid'
        "
      >
        Au moins 1 chiffre
      </p>
      <p
        [ngClass]="
          parentFormGroup.controls.password?.errors?.required ||
          parentFormGroup.controls.password?.errors?.hasCapitalCase
            ? 'fr-message--error'
            : 'fr-message--valid'
        "
      >
        Au moins une lettre en majuscule
      </p>
      <p
        [ngClass]="
          parentFormGroup.controls.password?.errors?.required ||
          parentFormGroup.controls.password?.errors?.hasLowerCase
            ? 'fr-message--error'
            : 'fr-message--valid'
        "
      >
        Au moins une lettre en minuscule
      </p>
      <p
        [ngClass]="
          parentFormGroup.controls.password?.errors?.required ||
          parentFormGroup.controls.password?.errors?.hasSpecialCharacter
            ? 'fr-message--error'
            : 'fr-message--valid'
        "
      >
        Au moins un caractère spécial:
        &#64;[]^_!"#$%&amp;&apos;()*+,\-./:;&lbrace;&rbrace;&lt;&gt;=|~?
      </p>
      <p
        [ngClass]="
          parentFormGroup.controls.password?.errors?.required ||
          parentFormGroup.controls.password?.errors?.minlength ||
          parentFormGroup.controls.password?.errors?.maxlength
            ? 'fr-message--error'
            : 'fr-message--valid'
        "
      >
        Doit contenir entre 12 et 150 caractères
      </p>
    </div>
    <div class="fr-password__checkbox fr-checkbox-group fr-checkbox-group--sm">
      <input
        id="show-password"
        [attr.aria-label]="
          (hidePassword ? 'Voir' : 'Masquer') + ' le mot de passe'
        "
        class="fr-checkbox"
        role="switch"
        [attr.aria-checked]="!hidePassword"
        (change)="togglePassword()"
        type="checkbox"
      />
      <label class="fr--password__checkbox fr-label" for="show-password">
        Afficher
      </label>
    </div>
  </div>
  <div class="col-md-6 col-12 fr-password required align-items-start">
    <label class="fr-password__label fr-label" for="passwordConfirmationInput"
      >Confirmer votre mot de passe</label
    >
    <div class="fr-input-wrap">
      <input
        class="fr-password__input fr-input"
        [type]="!hidePasswordConfirmation ? 'text' : 'password'"
        [ngClass]="{
          'is-invalid':
            (parentFormGroup.controls.passwordConfirmation.dirty ||
              submitted) &&
            (parentFormGroup.controls.passwordConfirmation.errors ||
              parentFormGroup?.errors?.noPassswordMatch),
          'is-valid':
            parentFormGroup.controls.passwordConfirmation.dirty &&
            !parentFormGroup.controls.passwordConfirmation.errors &&
            !parentFormGroup?.errors?.noPassswordMatch
        }"
        aria-describedby="invalid-confirmation-password"
        [attr.aria-invalid]="
          (parentFormGroup.controls.passwordConfirmation.dirty || submitted) &&
          (parentFormGroup.controls.passwordConfirmation.errors ||
            parentFormGroup?.errors?.noPassswordMatch)
            ? true
            : false
        "
        id="passwordConfirmationInput"
        autocomplete="new-password"
        (ngModelChange)="setPasswordConfirm($event)"
        [(ngModel)]="passwordConfirmation"
        name="passwordConfirmation"
        required
      />
    </div>
    <div class="fr-messages-group" id="invalid-confirmation-password">
      <p
        class="fr-message--error col-md-12"
        *ngIf="
          passwordConfirmation &&
          parentFormGroup.controls.passwordConfirmation?.errors?.required
        "
      >
        La confirmation du mot de passe est obligatoire
      </p>

      <p
        [ngClass]="
          passwordConfirmation && !parentFormGroup?.errors?.noPassswordMatch
            ? 'fr-message--valid'
            : 'fr-message--error'
        "
      >
        Les mots de passe doivent être identiques
      </p>
    </div>
    <div class="fr-password__checkbox fr-checkbox-group fr-checkbox-group--sm">
      <input
        id="show-passwordConfirmation"
        class="input-group-text"
        (click)="togglePasswordConfirmation()"
        role="switch"
        [attr.aria-checked]="!hidePasswordConfirmation"
        [attr.aria-label]="
          (hidePasswordConfirmation ? 'Voir' : 'Masquer') +
          ' la confirmation du mot de passe'
        "
        type="checkbox"
      />
      <label
        class="fr--password__checkbox fr-label"
        for="show-passwordConfirmation"
      >
        Afficher
      </label>
    </div>
  </div>
</div>
