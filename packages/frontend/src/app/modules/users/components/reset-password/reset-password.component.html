<div *ngIf="!token">
  <div class="step_form my-5" *ngIf="success">
    <div class="text-center">
      <fa-icon
        aria-hidden="true"
        class="fa-4x"
        [icon]="['fas', 'check-circle']"
      ></fa-icon>
      <br />
      <h3 class="text-success">
        Vous venez de recevoir un mail pour réinitialiser votre mot de passe
      </h3>
      <p class="text-center">N'oubliez pas de vérifier vos spams.</p>
    </div>
  </div>

  <div class="step_form text-center" *ngIf="!success">
    <h1 class="title">Vous avez oublié votre mot de passe ?</h1>
    <p>
      Veuillez saisir l'adresse email de votre compte afin de recevoir la
      procédure pour le réinitialiser
    </p>

    <form [formGroup]="emailForm" (ngSubmit)="submitEmailForm()">
      <div class="row">
        <div class="form-group required col-8 offset-2">
          <label for="email">Adresse email</label>
          <input
            type="email"
            formControlName="email"
            id="email"
            class="form-control"
            autocomplete="email"
            required
            [ngClass]="{ 'is-invalid': submitted && e.email.errors }"
          />
          <p
            *ngIf="(submitted || e.email.dirty) && e.email.errors"
            class="invalid-feedback"
          >
            Veuillez vérifier l'adresse email, format attendu : nom@domaine.fr
          </p>
        </div>
      </div>
      <button type="submit" [disabled]="loading" class="btn btn-primary mb-2">
        <span *ngIf="loading">
          <fa-icon
            [icon]="['fas', 'circle-notch']"
            aria-hidden="true"
            [spin]="true"
          >
          </fa-icon>
          Veuillez patienter...
        </span>
        <span *ngIf="!loading">Envoyer</span>
      </button>
    </form>
  </div>
</div>

<div *ngIf="token">
  <div class="step_form" *ngIf="success">
    <div class="text-center">
      <fa-icon
        class="fa-4x"
        [icon]="['fas', 'check-circle']"
        aria-hidden="true"
      ></fa-icon>
      <br />
      <h5 class="text-success">
        Félicitations, votre mot de passe a été réinitialisé
      </h5>
      <br />
      <a
        routerLink="/connexion"
        routerLinkActive="router-link-active"
        class="btn btn-outline-dark"
      >
        Se connecter
      </a>
    </div>
  </div>

  <div class="step_form" *ngIf="!success">
    <div class="text-center">
      <h1 class="title">Veuillez saisir un nouveau mot de passe</h1>
    </div>
    <br />
    <form [formGroup]="resetForm" (ngSubmit)="submitResetForm()">
      <div class="row">
        <app-user-structure-password-form
          [parentFormGroup]="resetForm"
          [submitted]="submitted"
        ></app-user-structure-password-form>
      </div>
      <div class="text-center">
        <input type="hidden" formControlName="token" />
        <button
          type="submit"
          [disabled]="resetForm.invalid"
          class="btn btn-primary mb-2"
        >
          Enregistrer
        </button>
      </div>
    </form>
  </div>
</div>
