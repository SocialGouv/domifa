<h4 class="title">Créer un utilisateur</h4>
<form #form [formGroup]="userForm" (ngSubmit)="submitUser()">
  <div class="row">
    <div class="col-md-3 form-group required">
      <label for="nom">Nom</label>
      <input
        type="text"
        class="form-control"
        id="nom"
        cleanStr
        formControlName="nom"
        [ngClass]="{ 'is-invalid': (f.nom.dirty || submitted) && f.nom.errors }"
        required
      />
      <p *ngIf="submitted && f.nom.errors" class="invalid-feedback">
        Veuillez vérifier le nom
      </p>
    </div>
    <div class="col-md-3 form-group required">
      <label for="prenom">Prénom</label>
      <input
        type="text"
        class="form-control"
        id="prenom"
        cleanStr
        formControlName="prenom"
        [ngClass]="{
          'is-invalid': (f.prenom.dirty || submitted) && f.prenom.errors
        }"
        required
      />
      <p *ngIf="submitted && f.prenom.errors" class="invalid-feedback">
        Veuillez vérifier le prénom
      </p>
    </div>
    <div class="col-md-3 form-group required">
      <label for="email">Adresse email</label>
      <input
        type="email"
        class="form-control"
        id="email"
        autocomplete="username"
        formControlName="email"
        [ngClass]="{
          'is-invalid': (f.email.dirty || submitted) && f.email.errors
        }"
        required
      />
      <div *ngIf="f.email.errors" class="invalid-feedback">
        <p *ngIf="f.email.errors.emailTaken">
          <fa-icon [icon]="['fas', 'exclamation-triangle']"></fa-icon>
          <strong>L'adresse email est déjà utilisée</strong>
        </p>
        <p *ngIf="!f.email.errors.emailTaken">L'adresse Email est incorrecte</p>
      </div>
    </div>
    <div class="col-md-3 form-group required">
      <label for="role">Accès</label>
      <select
        id="role"
        formControlName="role"
        [ngClass]="{
          'is-invalid': submitted && f.role.errors
        }"
        class="form-select"
        required
      >
        <option></option>
        <option value="admin">Administrateur</option>
        <option value="responsable">Gestionnaire</option>
        <option value="simple">Instructeur</option>
        <option value="facteur">Facteur</option>
      </select>
      <p *ngIf="submitted && f.role.errors" class="invalid-feedback">
        Le rôle est obligatoire
      </p>
    </div>
    <div class="col-12 text-center">
      <button class="btn btn-primary" type="submit" [disabled]="loading">
        <span *ngIf="loading">
          <fa-icon [icon]="['fas', 'circle-notch']" [spin]="true"> </fa-icon>
          Veuillez patienter...
        </span>
        <span *ngIf="!loading">Ajouter cet utilisateur</span>
      </button>
    </div>
  </div>
</form>
