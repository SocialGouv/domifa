<!-- header.component.html -->
<app-alerte-confidentialite></app-alerte-confidentialite>
<header role="banner" class="fr-header" id="mainHeader">
  <div class="fr-header__body">
    <div class="fr-container">
      <div class="fr-header__body-row">
        <div class="fr-header__brand fr-enlarge-link">
          <div class="fr-header__brand-top">
            <div class="fr-header__logo">
              <p class="fr-logo">République <br />française</p>
            </div>

            <div class="fr-header__operator">
              <a
                href="/"
                title="Retour à l'accueil du site - Domifa - République Française"
              >
                <img
                  class="fr-responsive-img"
                  src="assets/images/logo-dsfr.svg"
                  alt="Retour à l'accueil du site - Domifa - République Française"
                />
              </a>
            </div>

            <!-- Bouton burger mobile -->
            <div class="fr-header__navbar">
              <button
                data-fr-opened="false"
                aria-controls="header-modal-menu"
                title="Menu"
                type="button"
                id="navbar-site"
                class="fr-btn--menu fr-btn"
              >
                Menu
              </button>
            </div>
          </div>
        </div>

        <!-- DESKTOP : Quick access + dropdown utilisateur -->
        <div class="fr-header__tools">
          <div class="fr-header__tools-links">
            @if (!me) {
            <ul class="fr-btns-group">
              <li>
                <a routerLink="/news" class="fr-btn fr-btn--tertiary">
                  @if (pendingNews) {
                  <span class="fr-badge fr-badge--sm fr-badge--error fr-mr-1w"
                    >New</span
                  >
                  } Nouveautés
                </a>
              </li>
              <li>
                <a routerLink="/faq" class="fr-btn fr-btn--tertiary">
                  En savoir plus
                </a>
              </li>
              <li>
                <a
                  routerLink="/connexion"
                  class="fr-btn fr-icon-account-circle-line fr-btn--icon-left"
                  (click)="
                    matomoService.trackEvent('CONNEXION', 'HEADER', 'null', 1)
                  "
                >
                  Me connecter
                </a>
              </li>
            </ul>
            } @else { @if (me) {
            <ul class="fr-btns-group">
              <li>
                <a
                  [attr.aria-current]="
                    isCurrentRoute('/manage') ? 'page' : null
                  "
                  [routerLink]="'/manage'"
                  class="fr-btn fr-btn--tertiary"
                >
                  <img
                    src="/assets/icones/dsfr/domicilies.svg"
                    alt=""
                    class="fr-icon--xs fr-mr-1w"
                  />
                  Domiciliés
                </a>
              </li>
            </ul>
            }
            <app-login-dropdown [me]="me"></app-login-dropdown>

            }
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MENU MOBILE MODAL -->
  <div
    class="fr-header__menu fr-modal"
    id="header-modal-menu"
    aria-labelledby="navbar-site"
  >
    <div class="fr-container">
      <button
        aria-controls="header-modal-menu"
        title="Fermer"
        type="button"
        class="fr-btn--close fr-btn"
      >
        Fermer
      </button>

      <nav
        class="fr-nav"
        id="header-navigation"
        role="navigation"
        aria-label="Menu principal"
      >
        <ul class="fr-nav__list">
          <!-- NON CONNECTÉ -->
          @if (!me) {
          <!-- Dropdown Se connecter -->
          <li class="fr-nav__item">
            <button
              class="fr-nav__btn"
              aria-expanded="false"
              aria-controls="menu-connexion-mobile"
              type="button"
            >
              Se connecter
            </button>
            <div class="fr-collapse fr-menu" id="menu-connexion-mobile">
              <ul class="fr-menu__list">
                <li>
                  <a routerLink="/connexion" class="fr-nav__link">
                    <span
                      class="fr-icon-home-4-line fr-mr-1w"
                      aria-hidden="true"
                    ></span>
                    CCAS, organismes agréés
                  </a>
                </li>
                <li>
                  <a
                    href="https://mon-domifa.fabrique.social.gouv.fr/"
                    class="fr-nav__link"
                  >
                    <span
                      class="fr-icon-mail-line fr-mr-1w"
                      aria-hidden="true"
                    ></span>
                    Domiciliés
                  </a>
                </li>
                <li>
                  <a
                    href="https://admin.fabrique.social.gouv.fr/"
                    class="fr-nav__link"
                  >
                    <span
                      class="fr-icon-building-line fr-mr-1w"
                      aria-hidden="true"
                    ></span>
                    DGCS
                  </a>
                </li>
              </ul>
            </div>
          </li>

          <!-- Liens directs -->
          <li class="fr-nav__item">
            <a
              class="fr-nav__link"
              routerLink="/"
              [attr.aria-current]="isCurrentRoute('/') ? 'page' : null"
            >
              Accueil
            </a>
          </li>
          <li class="fr-nav__item">
            <a
              class="fr-nav__link"
              routerLink="/structures/inscription"
              [attr.aria-current]="
                isCurrentRoute('/structures/inscription') ? 'page' : null
              "
            >
              Inscrire ma structure
            </a>
          </li>
          <li class="fr-nav__item">
            <a
              class="fr-nav__link"
              routerLink="/stats"
              [attr.aria-current]="isCurrentRoute('/stats') ? 'page' : null"
            >
              Statistiques
            </a>
          </li>
          <li class="fr-nav__item">
            <a
              class="fr-nav__link"
              routerLink="/stats/impact"
              [attr.aria-current]="
                isCurrentRoute('/stats/impact') ? 'page' : null
              "
            >
              Impact
            </a>
          </li>
          <li class="fr-nav__item">
            <a
              class="fr-nav__link"
              routerLink="/news"
              [attr.aria-current]="isCurrentRoute('/news') ? 'page' : null"
            >
              @if (pendingNews) {
              <span class="fr-badge fr-badge--sm fr-badge--error fr-mr-1w"
                >New</span
              >
              } Nouveautés
            </a>
          </li>
          <li class="fr-nav__item">
            <a
              class="fr-nav__link"
              routerLink="/decouvrir-domifa"
              [attr.aria-current]="
                isCurrentRoute('/decouvrir-domifa') ? 'page' : null
              "
            >
              Découvrir DomiFa
            </a>
          </li>
          <li class="fr-nav__item">
            <a
              class="fr-nav__link"
              routerLink="/contact"
              [attr.aria-current]="isCurrentRoute('/contact') ? 'page' : null"
            >
              Nous contacter
            </a>
          </li>
          <li class="fr-nav__item">
            <a
              class="fr-nav__link"
              routerLink="/faq"
              [attr.aria-current]="isCurrentRoute('/faq') ? 'page' : null"
            >
              Besoin d'aide
            </a>
          </li>
          }
        </ul>
      </nav>

      <!-- Menu utilisateur mobile -->
      @if (me) {
      <div class="fr-header__menu-links">
        <app-login-dropdown [me]="me"></app-login-dropdown>
      </div>
      }
    </div>
  </div>
</header>
