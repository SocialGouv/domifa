<div class="head-page py-4">
  <div class="container">
    <h1>Se connecter à DomiFa</h1>
  </div>
</div>
<div class="container my-4">
  <div class="row">
    <div class="col-12 col-md-6">
      <div class="step-form text-center">
        <div class="my-2">
          <h2 class="title">
            Je suis domicilié dans un CCAS, un CIAS ou une association
          </h2>
          <br />
          <br />
          <p>
            Cliquez sur le lien ci-dessous pour savoir si vous avez du courrier
            à récupérer
          </p>
          <br />
          <a
            [href]="portailUsagerUrl"
            rel="noopener noreferrer"
            class="btn btn-primary"
            >Me connecter à Mon DomiFa</a
          >
        </div>
      </div>
    </div>
    <div class="col-12 col-md-6">
      <div class="step-form">
        <div class="text-center my-2">
          <h2 class="title">
            Je suis un professionnel ou bénévole d’une structure
          </h2>
        </div>
        <br />
        <form [formGroup]="loginForm" (ngSubmit)="login()">
          <div class="row justify-content-center">
            <div class="col-md-8">
              <p>
                Les champs suivis d'un
                <span class="fw-bold text-danger">*</span> sont obligatoires
              </p>
            </div>
            <div class="col-md-8">
              <div class="form-group required">
                <label for="email">Adresse email</label>
                <input
                  type="email"
                  id="email"
                  formControlName="email"
                  autocomplete="email"
                  required
                  class="form-control"
                  [ngClass]="{ 'is-invalid': f.email.dirty && f.email.errors }"
                  [attr.aria-invalid]="
                    f.email.dirty && f.email.errors ? true : false
                  "
                  [attr.aria-describedby]="
                    f.email.dirty && f.email.errors ? 'email-errors' : null
                  "
                />
                <p
                  *ngIf="f.email.dirty && f.email.errors"
                  id="email-errors"
                  class="invalid-feedback"
                >
                  Veuillez vérifier l'adresse email, format attendu :
                  nom@domaine.fr
                </p>
              </div>
              <div class="form-group required">
                <label for="password">Mot de passe </label>
                <div class="input-group">
                  <input
                    required
                    id="password"
                    formControlName="password"
                    [type]="!hidePassword ? 'text' : 'password'"
                    class="form-control"
                    autocomplete="current-password"
                    [attr.aria-invalid]="
                      f.password.dirty && f.password.errors ? true : false
                    "
                    [attr.aria-describedby]="
                      f.password.dirty && f.password.errors
                        ? 'invalid-password'
                        : null
                    "
                    [ngClass]="{
                      'is-invalid': f.password.dirty && f.password.errors
                    }"
                  />

                  <button
                    class="input-group-text"
                    type="button"
                    role="switch"
                    [attr.aria-checked]="!hidePassword"
                    [attr.aria-label]="
                      (hidePassword ? 'Afficher' : 'Masquer') +
                      ' le mot de passe'
                    "
                    (click)="togglePassword()"
                  >
                    <fa-icon
                      aria-hidden="true"
                      [icon]="
                        hidePassword ? ['far', 'eye'] : ['far', 'eye-slash']
                      "
                    ></fa-icon>
                  </button>

                  <p
                    *ngIf="f.password.dirty && f.password.errors"
                    class="invalid-feedback"
                    id="invalid-password"
                  >
                    Veuillez vérifier le mot de passe
                  </p>
                </div>
              </div>
              <div class="text-center py-2">
                <button
                  [disabled]="loading"
                  type="submit"
                  class="d-inline-block btn btn-primary mb-3"
                >
                  <span *ngIf="!loading"> Connexion </span>
                  <span *ngIf="loading"
                    ><fa-icon
                      [icon]="['fas', 'circle-notch']"
                      aria-hidden="true"
                      [spin]="true"
                    >
                    </fa-icon>
                    Connexion en cours...</span
                  >
                </button>
                <br />
                <a
                  routerLink="/reset-password"
                  class="d-inline-block btn btn-link"
                >
                  Mot de passe oublié
                </a>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
