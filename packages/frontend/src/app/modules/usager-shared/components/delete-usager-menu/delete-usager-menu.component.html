@if (me?.role !== 'facteur' && me?.role !== 'agent') { @if ( me?.role !==
'simple' && (context === 'PROFIL' || context === 'INSTRUCTION_FORM') ) {
<div class="fr-container fr-py-5v" style="text-align: center">
  <button
    type="button"
    class="fr-icon-delete-line fr-btn--icon-left fr-btn"
    (click)="onDeleteClick()"
  >
    {{
      context === "PROFIL" ? "Supprimer ce dossier" : "Supprimer cette demande"
    }}
  </button>
</div>
} @if (context === 'HISTORY' && usager.historique.length > 1 && isAdmin) {
<button
  type="button"
  class="fr-btn fr-btn--primary fr-icon-delete-line fr-btn--icon-left"
  aria-label="Supprimer la dernière décision"
  (click)="deleteDecisionModal.open()"
>
  <span>Supprimer la dernière décision</span>
</button>
} }

<dsfr-modal #deleteDecisionModal [isScrollable]="true" [size]="'LG'">
  <p>
    Vous êtes sur le point de supprimer la décision suivante:<br />
    <strong>
      {{ DECISION_LABELS[usager.decision.statut] }} le
      {{ usager.decision.dateDecision | date : "d MMMM y à HH:mm" }} par
      {{ usager.decision.userName }}
    </strong>
  </p>
  <p>
    Les statistiques seront mises à jour, une note sera ajoutée au dossier et
    l'usager retournera à son statut précédent:
    <strong>{{ previousStatus }}</strong>
  </p>

  <ng-container dsfrModalActions>
    <button
      type="submit"
      class="fr-btn fr-btn--primary"
      (click)="deleteDecision()"
      [disabled]="loading"
      [attr.aria-busy]="loading"
    >
      <span class="fr-icon-check-line" aria-hidden="true"></span>
      <span *ngIf="!loading">Confirmer la suppression</span>
      @if (loading) {
      <span>
        <span
          class="fr-icon-loader-4-line fr-animate-spin"
          aria-hidden="true"
        ></span>
        Veuillez patienter...
      </span>
      }
    </button>
    <button
      type="button"
      class="fr-btn fr-btn--secondary"
      (click)="deleteDecisionModal.close()"
    >
      <span class="fr-icon-close-line" aria-hidden="true"></span>
      Annuler
    </button>
  </ng-container>
</dsfr-modal>

<dsfr-modal
  #deleteUsagerModal
  [titleModal]="modalTitle"
  [isScrollable]="false"
  [size]="'LG'"
>
  <app-delete-usager
    [selectedRefs]="selectedRefs"
    [context]="context === 'PROFIL' ? 'PROFIL' : 'INSTRUCTION_FORM'"
  ></app-delete-usager>
</dsfr-modal>
