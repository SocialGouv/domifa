<button
  type="button"
  class="mt-4 btn btn-outline-primary me-2"
  (click)="openAddNoteInModal()"
>
  <fa-icon [icon]="['fas', 'plus']" aria-hidden="true" class="me-2"></fa-icon>
  Ajouter une note
</button>

<ng-template #addNoteInModal let-modal>
  <div class="modal-header">
    <span class="modal-title">
      Nouvelle note concernant
      <span class="text-primary">{{ usager.nom }} {{ usager.prenom }} </span>
    </span>
  </div>
  <form ngNativeValidate [formGroup]="addNoteForm" (ngSubmit)="submit()">
    <div class="modal-body text-center">
      <div class="form-group required">
        <label class="label text-start" for="message"
          >Contenu de la note (1000 caractères maximum)</label
        >
        <textarea
          class="form-control"
          formControlName="message"
          id="message"
          maxlength="1000"
          required
        ></textarea>

        <p *ngIf="submitted && f.message.errors" class="invalid-feedback">
          La note saisie est incorrect. 1000 caractères maximum
        </p>
      </div>
      <app-rgpd-warning></app-rgpd-warning>
    </div>
    <div class="modal-footer text-end">
      <button
        [disabled]="loading"
        type="submit"
        class="btn btn-lg btn-primary mx-1"
      >
        <span *ngIf="!loading">Enregistrer la note</span>
        <span *ngIf="loading">
          <fa-icon
            [icon]="['fas', 'circle-notch']"
            [spin]="true"
            aria-hidden="true"
          ></fa-icon>
          Veuillez patienter...
        </span>
      </button>

      <button
        type="button"
        class="btn btn-outline-dark btn-lg me-2"
        (click)="cancel.emit()"
      >
        Annuler
      </button>
    </div>
  </form>
</ng-template>
