<h3>Historique des envois de SMS</h3>

<p>Rappel: les domiciliés peuvent recevoir 2 type de SMS</p>
<ul class="mb-4">
  <li>
    Un sms pour indiquer l'arrivée d'un courrier à 19h selon les jours choisis
    par votre structure (Mardi et jeudi par défaut)
  </li>
  <li>
    Un SMS de rappel envoyé 1 mois avant la date de fin de la domiciliation.
    Celui-ci indique au domicilié que sa domiciliation arrive à échéance.
  </li>
</ul>

<div class="table-responsive" *ngIf="searchResults.data?.length">
  <table class="table-history table">
    <caption class="visually-hidden">
      Historique des SMS envoyés
    </caption>
    <thead>
      <tr>
        <th scope="col">Date d'envoi</th>
        <th scope="col">Statut</th>
        <th scope="col">Type de SMS</th>
        <th scope="col">Numéro de téléphone</th>
        <th scope="col">Contenu</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let sms of searchResults.data">
        <td>
          {{
            (sms.sendDate ? sms.sendDate : sms.scheduledDate)
              | date : "dd MMMM yyyy à HH:mm"
          }}
        </td>
        <td>{{ SMS_STATUS_LABELS[sms.status] }}</td>
        <td>{{ SMS_LABELS[sms.smsId] }}</td>
        <td>{{ sms.phoneNumber }}</td>
        <td>{{ sms.content }}</td>
      </tr>
    </tbody>
  </table>
</div>
<div
  class="justify-content-center d-flex p-3 d-print-none"
  *ngIf="
    searchResults.data.length > 0 && searchResults.meta.itemCount >= params.take
  "
>
  <div
    class="results-selector justify-content-start align-items-center d-flex me-auto"
  >
    <select
      name="limit"
      [(ngModel)]="params.take"
      (ngModelChange)="getSms()"
      id="limit"
    >
      <option [ngValue]="10">10</option>
      <option [ngValue]="50">50</option>
      <option [ngValue]="100">100</option>
      <option [ngValue]="250">250</option>
      <option [ngValue]="500">500</option>
    </select>
    <label for="limit" class="ms-3 fw-bold">résultats par page </label>
  </div>

  <ngb-pagination
    [collectionSize]="searchResults.meta.itemCount"
    [(page)]="params.page"
    [boundaryLinks]="true"
    [rotate]="true"
    [maxSize]="5"
    [pageSize]="params.take"
    (pageChange)="getSms()"
  ></ngb-pagination>
</div>

@if (searchResults?.data?.length === 0) {
<div class="fr-alert fr-alert--info">
  <p>Aucun sms enregistré actuellement</p>
</div>
}
