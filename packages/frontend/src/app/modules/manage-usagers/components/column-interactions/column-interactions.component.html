@if (template === 'small-buttons' && usager) { @if
(usager?.echeanceInfos?.isActif) {
<div class="interaction-buttons">
  <button
    type="button"
    [id]="'visite-' + usager.ref"
    [disabled]="isInteractionLoading.visite"
    [attr.aria-busy]="isInteractionLoading.visite"
    [attr.aria-label]="'Ajout d\'un passage pour ' + (usager | fullName)"
    [title]="'Ajout d\'un passage pour ' + (usager | fullName)"
    class="interaction-btn fr-btn fr-btn--tertiary-no-outline"
    (click)="setSingleInteraction(usager, 'visite')"
  >
    <span class="icon-passage list-icon" aria-hidden="true"></span>
  </button>
  <button
    type="button"
    [id]="'appel-' + usager.ref"
    [disabled]="isInteractionLoading.appel"
    [attr.aria-busy]="isInteractionLoading.appel"
    [attr.aria-label]="
      'Ajout d\'un appel téléphonique pour ' + (usager | fullName)
    "
    [title]="'Ajout d\'un appel téléphonique pour ' + (usager | fullName)"
    class="interaction-btn fr-btn fr-btn--tertiary-no-outline"
    (click)="setSingleInteraction(usager, 'appel')"
  >
    <span class="icon-appel list-icon" aria-hidden="true"></span>
  </button>
</div>
} } @if (template === 'big-buttons' && usager) { @if
(usager?.echeanceInfos?.isActif || (usager.decision.statut === 'RADIE' &&
!usager.options.npai.actif)) {
<div class="interaction-buttons">
  <button
    type="button"
    [id]="'courrierIn-' + usager.ref"
    [disabled]="isInteractionLoading.courrierIn"
    [attr.aria-busy]="isInteractionLoading.courrierIn"
    [attr.aria-label]="'Ajout d\'un courrier pour ' + (usager | fullName)"
    [title]="'Ajout d\'un courrier pour ' + (usager | fullName)"
    class="interaction-btn fr-btn fr-btn--tertiary-no-outline"
    (click)="setSingleInteraction(usager, 'courrierIn')"
  >
    <span aria-hidden="true" class="icon-courrier list-icon"></span>
  </button>

  <button
    type="button"
    [attr.aria-label]="
      'Réception de courriers, colis ou recommandés pour ' + (usager | fullName)
    "
    [title]="
      'Réception de courriers, colis ou recommandés pour ' + (usager | fullName)
    "
    [id]="'reception-' + usager.ref"
    class="interaction-btn fr-btn fr-btn--tertiary-no-outline"
    (click)="openInteractionInModal()"
  >
    <span aria-hidden="true" class="icon-reception list-icon"></span>
  </button>

  @if (usager.lastInteraction.enAttente) {
  <button
    class="interaction-btn fr-btn fr-btn--tertiary-no-outline"
    type="button"
    [id]="'distribution-' + usager.ref"
    [attr.aria-label]="
      'Distribuer ' +
      usager.standByInteractions +
      ' courriers de ' +
      (usager | fullName)
    "
    [title]="
      'Distribuer ' +
      usager.standByInteractions +
      ' courriers de ' +
      (usager | fullName)
    "
    (click)="openInteractionOutModal()"
  >
    <span class="icon-distribution list-icon" aria-hidden="true"></span>
    <strong class="notification">
      {{ usager.standByInteractions }}
    </strong>
  </button>
  }
</div>
} }

<dsfr-modal
  #setInteractionInModal
  titleModal="Réception de courriers"
  size="LG"
  (conceal)="cancelReception('reception', usager.ref)"
>
  @if (usager) {
  <app-set-interaction-in-form
    [usager]="usager"
    (cancelReception)="closeInteractionInModal('reception', usager.ref)"
  ></app-set-interaction-in-form>
  }
</dsfr-modal>

<dsfr-modal
  #setInteractionOutModal
  titleModal="Distribuer les courriers"
  size="MD"
  (conceal)="cancelReception('distribution', usager.ref)"
>
  @if (usager) {
  <app-set-interaction-out-form
    [usager]="usager"
    (cancelReception)="closeInteractionOutModal('distribution', usager.ref)"
    (updateInteractions)="updateInteractions.emit()"
  ></app-set-interaction-out-form>
  }
</dsfr-modal>
