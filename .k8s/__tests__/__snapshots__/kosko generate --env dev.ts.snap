// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`kosko generate --dev 1`] = `
"---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: backend
    application: domifa
    component: domifa
    owner: domifa
    team: domifa
    cert: wildcard
  name: backend
  namespace: domifa-mybranch
spec:
  replicas: 1
  selector:
    matchLabels:
      app: backend
  template:
    metadata:
      annotations:
        kapp.k14s.io/disable-default-ownership-label-rules: ''
        kapp.k14s.io/disable-default-label-scoping-rules: ''
        app.github.com/job: '5678'
        app.github.com/ref: refs/heads/mybranch
        app.github.com/repo: socialgouv/domifa
        app.github.com/run: '1234'
        app.github.com/sha: '0123456'
      labels:
        app: backend
        application: domifa
        component: domifa
        owner: domifa
        team: domifa
        cert: wildcard
    spec:
      containers:
        - image: >-
            ghcr.io/socialgouv/domifa/backend:sha-9e3027bc7c6dab66be874658abdc12c946fd0357
          livenessProbe:
            failureThreshold: 6
            httpGet:
              path: /healthz
              port: http
            initialDelaySeconds: 30
            periodSeconds: 15
            timeoutSeconds: 5
          name: backend
          ports:
            - containerPort: 3000
              name: http
          readinessProbe:
            failureThreshold: 15
            httpGet:
              path: /healthz
              port: http
            initialDelaySeconds: 30
            periodSeconds: 15
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 256Mi
            requests:
              cpu: 50m
              memory: 128Mi
          startupProbe:
            failureThreshold: 12
            httpGet:
              path: /healthz
              port: http
            periodSeconds: 15
            initialDelaySeconds: 30
          volumeMounts:
            - mountPath: /mnt/files
              name: files
          envFrom:
            - secretRef:
                name: azure-pg-user-mybranch
            - secretRef:
                name: backend-sealed-secret
            - configMapRef:
                name: backend-configmap
          env:
            - name: POSTGRES_HOST
              value: $(PGHOST)
            - name: POSTGRES_USERNAME
              value: $(PGUSER)
            - name: POSTGRES_PASSWORD
              value: $(PGPASSWORD)
            - name: POSTGRES_DATABASE
              value: $(PGDATABASE)
            - name: DOMIFA_BACKEND_URL
              value: https://domifa-api-domifa-mybranch.dev2.fabrique.social.gouv.fr
            - name: DOMIFA_FRONTEND_URL
              value: https://domifa-mybranch.dev2.fabrique.social.gouv.fr
      volumes:
        - name: files
          emptyDir: {}
      initContainers:
        - env:
            - name: WAIT_FOR_RETRIES
              value: '24'
          envFrom:
            - secretRef:
                name: azure-pg-user-mybranch
          image: ghcr.io/socialgouv/docker/wait-for-postgres:6.45.0
          imagePullPolicy: Always
          name: wait-for-postgres
          resources:
            limits:
              cpu: 20m
              memory: 32Mi
            requests:
              cpu: 5m
              memory: 16Mi
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  annotations:
    sealedsecrets.bitnami.com/cluster-wide: 'true'
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  name: backend-sealed-secret
  namespace: domifa-mybranch
  labels:
    application: domifa
    component: domifa
    owner: domifa
    team: domifa
    cert: wildcard
spec:
  encryptedData:
    DOMIFA_SECURITY_JWT_SECRET: >-
      AgAS9+czzoJ8Srab21D6kq0rnv3fejKN5/UeSVhvSSvnwmsBpuHBACbRZS9mGVpChZDQsf4mLJBDWNsQ5o5p8KIkp8fZ6MNr9W8xoIesmpt4oYTK65dEHFU3nvvcsKQ7zB1y/JgL7SQDWh2HArOYlcPE/3XGuhmZgbMQzSUITsEDKHf4bralo0jSoaMNJCxuZgdxAqRN6f8qtdiLZgbjs1JjX1PvDC6Uf+G79l+85HeX7sjQLjmjtT10xwW6LzCh1oTMc8SxRG2nA564Je6GYxmJNs/O1FNLlcjKxbdOsH6ZISk7n91UMibckYHzzWR+8UvVbi/Vr5pgPxxx5rjhsIpR5ywLeSjfzDM7fntMfXv+ZEVWstZcIxJwoupBsxiPVnkCHIhmRivK+bvDvosrsVILPEF1wsbBJUt5BUYetCA7xeD9BS8c7PP9H5duc3Psb2s+VXX4LzxEI8KwdZsBnfe+Lv2pD1mXYO/+Mhp/1zwJs7SUEZFUS68xoPsd8gvEO8oFTn+82Qesitdg/UHuaDs3QYZvk2Tcr6mduSsFRc514VHpg2xh7VPUD09LVETvqIQs2Fbk1TnjTm8tURnDx6DGFFXwZ8HgdwWl1irtVIRzwjXT2bqLIK26q3Pf+Xz5JWF2vbfZZT9BUpzYEE3j6sxg5XFmFlym32MrDkBSprIB/B0QbiDDVH77LxBSuczKh5moNJTi+mdBDpmqkpEcZBL8pF/tfOtupsswJhqwb1yQeWh45iifdljvngEzWihfS5k87mVbIEryzflwJUJxZQTATyFi4kYJs6A/4LgKzYaF/K8lYV36vyS5K6rgExBQ5yvgT2VAgaHNV89+a4xorGCbCVT+wLEYR4nT6bGaReiddU2Wspz9OQETHldHvQ0tQv1xxigpBKiYXeR67LnFYs4FWWAsKvqcQ/D7UIxfhxPzbEk7XfPhnG4vXk8=
    DOMIFA_SECURITY_FILES_PRIVATE: >-
      AgCX8fKNhEGDDjizFnXoiLXtMJ30HIc7svSc3H1i7WrVSM3GIGj0J3/lFdIK88QjP9vIG3AJSozbZ0Gp+JQVIvN9OmEZmM2gTVTc1Q0aq/51CYbphevlgacGdWJYSnmGWkdl+nfwqLEamX0zF12eLfW5wIBnm2RBzRT4wFU8aYX330MldF5qE/4MZOurQL48RTGXZ1GlX+1Dzsoa+bKPoJNuga4Cog1JspmKdf6nhob+HM4KvM8K/+gXh/PYZqG/wHoEa3kS8qOIQw0766u4nkCZ8Vu479pa24zQiUc4NAoqa2yT+aTRJKiNgPgiR1C7MiBWYK2SauO2J6FhqMyjbnvuhwZiDd7JGcA9rf9DAt9qpjPuCEe7crlrqFjRd1OfxuhOAp0GYd0bfihJtHXaJ+cHQ709zVjX2aU4wTItvH8UpC8OuqGHuGz7G+CSBuAYZANpFIMNZk7uq4CH2/E81GHt3JhKOXc9EMrUKyBKr+6nqOgJM5q9K7KW66lfup6hNnligDB+JAXNVFuWKK0QmGWInSxk9b7h3+0HSevtnHjIAH+mld8vr34+mLO6qLGZhjzrIzB+/1dOyQ7X1d7HiuG6cV60FPfKrTzEbwr+D+vay7DrOSJiS7dEX1YRAE6fH7lvP9VZZX8hur02mk/dG4D3rNFdu+DUp8k0N5ljnrKuNp4yTQMmk/xwQLC/Fu7Mi/Hjm3+y+ir8EvOwKnmjZwcUUt2hHpgauWwCxcy5UpiS5A==
    DOMIFA_SECURITY_FILES_IV: >-
      AgDTjOtxCkz8QFrP970VE2VZU3RnT2R4k4Tz+p88tVoFQ9Op/UkwK1QcSzd1E4Mlj6qaBErbyzlb6/Ij9DoIlmkbOl4nCycZzXu8mTdPY8ZJK8qotGiZuJhjy67DzTXp7ICC4l6Ox2jL3jr+YF3AeQypEn0qxWaNCl2tXoCjid4g5K/kct2qKkYZdnYgFDXlGqE3ULPTonc3QJ8Cy6kUEBuIumjc+xjbr6HEnWgAnaAK2HUIwQ3DRGzYSSSiNaiy0PmqHU0OJ4zF9i+BjYEYSReQEl5OSHDc+jpTph24m1AS8PcO+n4rag4fg0BiZ2vxRB4XgQcXQkNARSpYP42YJoouumkXXN8ltOQNkLxxOdT3wLJsOW20ZLDqK1R8gwmeXwEBQZ2KRSjMrTNjIVbzPLb3YTtgVI9kzWcZefjqpQXy6t/de2zP5C5Y7dElpSJ4C0d/yzCwQ7yGTa4tsFQGjgEiTeCSFpjT2h2osrz5bZFQRm2SkoRxhvY+daG8x/vIz9SxPzem2lSE5ORhVjsmg+iPHntR5x1/CZ2aZ5ElZBwFIkFSrhHBROjRyWkMeF+hDGQTgeKqpU87ZEfkrrE7GKF8fV5EoWoT1h4Dh71WisTxfffkXVW2JzdvQGRvc+xWh8b6VTCN42gUfZddcyC/Idf/pGiVT7wqHQXEjjHI3HZPf8PdAA8HsPm9Bg7gkjifeh6H37FYUmCkxqveKWnJZUhy
    DOMIFA_MAIL_SMTP_TIPIMAIL_HOST: >-
      AgAWtRKQjIGJzsEnpC025AtzBe/l7cHUnogzyg/BlZPTUFQhKKojvrg/ib++rf9jwVd68k89iPYq8DHMwgoA9c2N7UKfjDiidlMPghWDE1L4ZGNhY9qP4CPzqoBrDHPwhyb8oUUBS23mGsu9DKOx3WCxLsjGYP5FUZBgBn8Lw394OL+boRntDZRvBVb9U7tlm98OeJien46DFsT3zz1LZFh0pP1BeP6ZPNgeXTZz29GRPi5hq885KTAUkd4kL47DcM/wZtWnElcr2lKq0anqdnvTO4N/mvQHD98sPB64+m4G/PbY0DtSZfTi7qqFk9KaqERLIExaRBKs+EEpgVRs5htfq5Szqcp1LuWHVl5eqyA2Mcp7XJwQhD6j6zDmuaCLe+J1IhQldLdrjEX/r1aarDruKUqYK+T5AyrW6hPV5l58IESw5bDxfreKOxqK1sPXrpHADRo60fsbmaKDHfbRuLJqRa7wGSOn4rgHNxsA7/KKLoXFVAfmUH/0VwbxR0OjicLJnDDzc1nKVb1f6Y+R2jvlFgTnBsT+tKo5GJ3MhzW3Gyw/++RSfk/B1F78RhVwS2cPCPC9ehS2Ra88wezLRIWtCVKc2u1/Zq/eO4YHPmfSZUD547bIb003D2N2Ba2hMGgvX/f1wsAUpF3RiziZ/5LdKfQwXGdcWctrMGx2NXQOuecp9l/zMTEvkgelBVlZwjKHU1i9oDHlq9vknyJMkBDzdw==
    DOMIFA_MAIL_SMTP_TIPIMAIL_PORT: >-
      AgDPN7g4dxvDPuPzUJ3Khcwu31oEOTq0sgDFceXt8kzoIEXqSJVAD9G2OhYaUTEteQe8HFIvZg2PBPBejf4aOmOUPJM2UwI3r77SR3/MBKSbmqD6z2KJ1AAONwa/P6cosGM4qyhRTHcSUnqfmBDPvPYYd+rZZQKfw3Zz/mqrO0zleWxogRqXgXAZ5WVY2unQeWAzhQp0+EdVKpUpodBkFzLd662UYK0sz/Luvxmfg5pygZq4eEuYw7AqOrhAA7cSQtX4j48dfQ71HdZMEUjxFKnFXKy28ZcbakT4XYLVnQ74RgJ7ujn+jJCa40iDk38y6gv1TNEy16MfnYS5ifi3qKB44U3ryfH141l+VOr8fFll4BZlaRd90/sDlWW69aU0ywbrtG4KplcmQj0wkphbe5qfI99mRANRnFO9GZ0AlnOkk6a6pcUcACvBexd9Dmr21Ia2TukCGryp8g7BJrCVEyalXOIo5zm3JQNfBoF+SaKzDJvHLKPRS01lsCCqdePcFMmx6jQH9qoGoYxNzM2Pb6oh0FC02EfhCGQhLZ3KCIozJJDM5h4TfTYhGrBOubgfE6AkKiZ+APg/A2Lr0iYXwg8lTfn2JDDG0mcYjQ0fUZpovRE7/FIurfM6MjeSB9jnWw9KZhFyhIjsweFYu+/mz+Dhva2L3YoF2bS+OLPdxRToMSosZAs7U2/twyZt2FHSfcFCceA=
    DOMIFA_MAIL_SMTP_TIPIMAIL_USER: >-
      AgC50XdpTvnpy7XLhDt6AqJDtpV5iKhg4pRnrQ3upidyOAyD4nLIxIExsuUCbAssC+SYg90qYtQWJ08cN6LeukOz2xOE8WDyzxOqK/B/XW9n2GnT66T8xaniuKfqkmKqFHolaxUCl6byYWjZlVwz8IbHb93CkwbVEAMe/3ZndDHzFikkvJJIA78NtFtAcOv/vuA/aR1qD/PfSCssxonfjqLmExhNCEKyKZrAOTuu91jzbOU3LqzOS0XAl2aPqyjqQzpAKnHINvJbaqbPLEqgS8nFenKjSTFjdHQVrHW8KL+mNHkw7Vcfn0yu3Az0QZxz/qoUWr85F6hz5f0B9s2nSYMvEORDh9hOahfQ432TnApbcuD9oKAK9k8OZD4uxVHtEhH/0NWYEXJf3eds7HICfiKDW3OuFq/FxzEHvJEeX2k9EyL5qhedDXdKM55/wAyWmM2wCx3Uvj4NxZrzajFy6Ssrq2YpsfDE4XWYkvzaMMXfzRCYEE1XWty+BdFlibwfPSMj2RoTKu2RxN6frIksbWDLNwGiRg+CW+FDQszszZO0WEBTvMLQ5/s/foselRxR3Z+T5qbd3w+WvtBJSQ/+JZZJ/VnzwJDvg3WdBD7EDGxjkgGsRp8B/KE2aaYpW3Rp5n6439zTHSMDVJFoqtaYK16ZsPIP51mZU5UHlpzy7d4is72YCRKu8ahq8iDXfB12V8HfNskGYX4H0tei4AFgqLWK36RA3Agc617KCTDDnLvb4Q==
    DOMIFA_MAIL_SMTP_TIPIMAIL_PASSWORD: >-
      AgCOEMAy7lOhKeJMJKao9I4Hlhg74dz3gzVhUNC6LOmn0Ig98od20trYk73om+nWnfe2pN0414hmF4Dh4J1wFBrZS+fEOIgt7sWUbNb4J2vuTLheyGF/5n7b7eTVcdpbf60rxBKoK3Z/p1epoAIHk6k+0a+A2wHy9UvOWo2y7bFH3mrnffQmm8z46Ds7tMssJA1QeQtvFemg2BeamR9myWhzmI4VAPlCeWAqEigB5ngswYTNmgrgtO2yoCcf6z8zf9TX/nJn90LnkYxnA7GKqpN2VhqaqmzcVmjAIphZDFCVKuJr/oL+kUcHU6SjhAXvota2g1LBpcWalyUQAVIa0n3hsbjdxZjtRu0msU54d6uD4ENGnzL2klxn9Ju/IZL6hHDTLN0FKgUzDcbGnKvxF6TLvduAy+wKyw36l8UGDkh43r0PwNiZ2QDoV5pihP1dyY3I1a2UImsSv9f6PyNigYpcUhPeJiEuqI61qZF2rvYjre6GcLifjJCYTJ0GRQo/EvX2UkMC5f28GPC2KqT8/or9kykyU+jyzLXDPBuGfCUVERe7AhQq9H0jR95KASy2taeBQjKnVqA8xEc2rnpMOVpvhmlYbXQTHxMAFx+6ecdx45GmvwUYtaBUP3jM16iGNicpTI6X+fTMPf4OrG6qjJ3jpBmD6WZxwycSyYyeD0Cvgq4jCgzhcP6MVMA0E8jECBkkVbpfNCcabSK5Q7lbLBqkybuZufk3UznJT4Plml+fWg==
    DOMIFA_ERROR_REPORT_EMAILS: >-
      AgADo5TMo89GwHMF9sL+3bjrDbtkwHLzRpsGUgfaA+Qhj3Pf0tiwVzF3LIadjeD382jMpUwHOKYFCZ2TFZjwLpVAU3zF7q/bDiwNicxo2spdtzLTuJNExYcAKfN0CoPZPOomFxNTDpF77NzSkC6ajaZDnbg5xxVyVoWPunfSZsv8osrSrKVfFFxsLKJ4h9Lq9eYhvORkbmT9hXxMbI73WFvRwD0vPURDWAc2ueQe7S9o5tHJmY9tmwru3j6p94RqLmRCJT1WceONLNUx4kIVjjAaAHC0KkuZsnj6L5pUirkJ5fTElD88HkI13frjTyB7ASEQzds83nXSwSF2bM/5c9hLBCihikQzL9FmXlFtkCtgWtU08seyyER9PiqfHxzSoEjNWmHw8YuUXlSSQejkeDdR5E6XbND+0D35uZ0uSyX3aeqE21YmoHGaHJYO23x6hXDKvbs6uGqaqEHaMzeAQV9F6vPGtGqznK5pHiL3wUurXEuS8yxLYlrmqelabW4E3PD9q1X9eNuOWdUc9jWOZNk+LyTJeF3FyWLhRlu9DcptZeB2pBNuSto2UcEBytaK02K4r30A7gpPuhIsXgZQU6ojbF7z0vKvtow1xH1u0bl0O3DVm2ynQdsvZccYTFZBara9GRTcXZmUwD86oshSTEwCPL++dr44Tvwnr79zTzN0y/WuPJe5052sodRVKiwFbR4aOnyDzqIZmUCtK2paQ8Wca40//0JsvH8sM+oOLD0nJYtv94xXCwZoExZ8VUBtFJkPEJmYLrgrr/gDp+a7vVNS5uCOYT2Z3ZoBHqcCbMCD
    SENTRY_DSN: >-
      AgBQmkwLTTscyUsdSvN4oM9EdbHpE0gwIdeyqD6xbwkOti26Z1+9r2O5a0J8anflSv9QEnh5XMY00lEvy42IKwCvg7AAxoLR8TamS1F4v/1kMxZyeHrrGB9eU6QFlRVpvUiF9GVlwMFLr3LdtEP+3Llg6UPdFhJvKrWquM8+FERbOXZNCv0kWTCws7vLG64+M8jAMxQvLNWxXu49fEZQgzn0BJItg+D1dWeSS4nMl/V4qEa0y1eSqvs8pfExCyoJDyv1JwB5B/b5wA0fuyLJS0CKOkeEVTHAf4WPVNzaykx8r7zwMProC5JBP7IL4tf9Pt5rqWkXxXvhN38xN7CuitRfVuDfsayEc3PsWwaKwqzzHHl2A55qfIHvnRhp60vtgzxRFnEMnTM0TMNp1ye1WpuhHwCLTgpvb2ivfHUgOuxwl/td2kx/tVSiPWk7nyuQkMIOCcsNBKWXnKSISCOvFc031h5FW82kz1Q8oFDwCVY0KJxZ0z1K77HwMLpUlnbdyTI+2qVrogbD01/ykzHWT9ZzPGgnjmWqH3zlWFcEPyfAt/B/22M2GkhuYzgSX0M1WcBGg3Uvl8MCFx3B5Is89lmViEvw4fys+npq323rZ/IwFbDHw18glbdG08Ne25+gLP2wtKttxZefeLbP5cmC+oamu2rJ87L+tzAAQ4p1QN+kppjutu8FP9KlBRAluhBpQvY4g3WWaAW4mGQinYC40Na8eHP6+IYFuQkhXl/dUxcJDIQVNMrdCU5iYHLIrC17GHN8J0RbZVYIR9A49ULH837ONJmjmnyaSAi+Cg==
    DOMIFA_MAILJET_FROM_EMAIL: >-
      AgBGZmxHHxGfUJDiwCUs6FbjmbAy/lTaTjVqokwDVgmHzx2UUK1ZYy6M8wjAcu/4SmBesotFChHRd4UZyuF9EQFhSqHqk3w2+CQmfTrEMn9ZTCj5l5FnHEqFdT6kNZfS0b1BBK3dmQLZvqYdMXC5lZaeVTpea2jM0ie7eKho0Yz5Hu314W7dJ7fq+7dl3T8OiW37H1ySqaX15Av1lxnkxUXZ3JfVj9mLSidsCL15Y9w/yIUXETwoG9hjqVdlN0aqnJQig5DyteGqRsr/qPXJFzU63+7xvS32vMtOAPqIC5mAy8n4mqSouwzFpokJwb3JIRQ3GTCM7m81Pw8qTdq627ujsFo0zhSZxTQx5bKiHUX7tScLIxfbq5Ngj2aMHKic8Th8YrMvbhbPpndokbHwcDAxUGksK1gLRH3GOXbissFpNLl1FzqtJ4VpAtGTpV0/Txp4SOXhuD2XZh0YSDOKPKyhuVHtxQPpUHIoChjfS24ayLmZ5avw+o5gMwf2kyJkQJfVwAZL2xiIcTASg+ubO08537CvGZwmsWtwrZZcf8HfjYxBU+mQ+zFjMa+Io1X2atbZEXY9GaxTZqaIL31G+U5lBeKBuW9LcXYuDiOM+j+t6CJcv2lp6IyLMZgPPuuqIgOTH/MMj9f9vzbeT/tD8g1cNaFaG0ZoTcTyy4SW57MgvbkNjrk5W8+HwKHNb5Kxj2o7WEmlRn4W30SaRKVKoLDQJk6J6br56opUK4JhoRoQBrzRuq/gQg==
    DOMIFA_TIPIMAIL_FROM_EMAIL: >-
      AgCD0XSSgrhKyphxS22r6rkXzOn7XtM6dGZjbDjlxO9GMSw8TrxFLHZNq3KFUlXgt8AbkLNIBSKQXkaMqSMKuZXxMsysvCNHG08WfJmxzpP5QcnakdwGY3m6EVGtwjeb8M58MS4dBkM3qWSjrGVivColySRmwmmv5qXSAh8UnLfzucTCHuvqOquu+9qXVQabDHApsuucCq7rvoPtig5gGt+/olWwq3UnXDqRYsmEAnHWuGhhccCOIFg4u/uqYCHeP+E0rpCC3vJtANvQ1hO9zhXpFmkWQ2HfUyIaAN9l6FoH1xWFlAuiz6N9f444UPBns0EpN0oDDHocB1Zp7v55QU+CV3mucnwI6LoiZqlPcZOqvMW5qOb7hEvzkKC5nBaVVH23sje3Tf2y1OodVaQYZSRyFclMYe4WzoPBpqA4TbQs79wA2I4aBHpJdt0C47ZLIJsugON9gX4CslOMU90+Vaa+mOSWBBgLI4ljC70WXrqBuIHi7FWU09xUek+wDacD9GAE4l1YBDoGl8aOXsMRKwa62AC8XISK08FjmVWPiHSWkF2az++xaOPHZK2e9N6KsiwtQ9i18vnJC5qMMsmN/zBBWLj55dj8/L30RyQSUFYDvHaItDCKzvISWrpkow5ASaxxcNMz77pzYH28IKCSzMHP9WLQQRjzOwnqZqL5I8RgAmXQvz5xqIkNibUW5urJF3w4m7YnNnB6Z5AFIzwd4P1DEmPhZCHSWNgxbq/RzBz+bxGG/kQqpr0=
    DOMIFA_ADMIN_EMAIL: >-
      AgC2Zz0AhqqWqCEXO7A92IJNQf0RSrvBmG+2YfzhbzgARTHl2dOv0eKglfFQApNqq6lim/00ZtXUYe78A7b6y/p399yMOTLTTe9oGFnbuNifwFiHAInBEBn/hu3EBNfO9usgsuzLXr70wiz5DTqLz+invN9vGZk74IaSlim4CuYL0j7TTyMoFraEh2cfU1ehrNAGRn14gH9JL7a/98SS8/y6buUPsLwKg+5w5TQxomD1sNCfNAv6YvC6wzF1L+hB36vu4vmzfq2HNQGc8ojsYjXJ2KZhSoPHIdfWvV1dw12pFdyOtK4W2Q2Cxfhvg/nEGOibBzUBcDyVHXgqWI8RI3Dw/XBKTJn5Aid01I0OxNdrhFsMfv6dK5maX6n+vx/nNh6FaQJXsfftMZM0A0EC+gHWVQwYREp1b5wBQ0xU1WIO4Q7zC2tNiKGxFkUDHJMrgeRa249fw4xVoZzRDda9PoAFtDAxq3zaqqA04w9YzAr3o64KOqDj/Wh/Jdxqzm2Gx4B5dfMk7MIYm20gVAn+IIpd2ogWw2tCDheRDTXX/D8OCJT+tL71FjkvIVoRhUekbQUx9veiRzy/vW5BbGJfNpJNRk+q0UaQSkcr/UHywDsqPL2uJNWneURXZ6Io58NlEr/vATlEsbGAmgc8lOj2bMD4sJBJXevMsAarjuhijkIPs8Zc/bIH7IJLWZPYETZV/ICWmYaGIB9ryfUB+j8FlSSTHNI8RWMzmh+g7Z4f+uEeNSwC/MhVFg==
    DOMIFA_EMAIL_ADDRESS_REDIRECT_ALL_TO: >-
      AgBuZjgOsuc6Zbe6Zwhz6BPbW1efF674MS7zNPUD559wO1ZXxvWV4zdSZD8zIw6/fduk1T6VUYMn0+qicI1M51U0xI2jyTZdMeB6iBx2aOXkzYVVSKBRxKJIk/Cu0XSWw2lClqUJyZ1OUlVUaZmkGQO6fXR8YRBHyObiW/DC0EkZyk8Va4sBXh98Ot+rAHFGRcbCv9rMhYhPabytZZS4kUVsmkl1UA7awBWk3djOL6tqZm7LR2SMGVWDF55FBfBlsx/Q7qgAdL+r4H7PZbgDBsctTtqhS+q/ArA6G2cbylUcCxIHa591OYtackgvMWJk2gHMtbUAjSzI/QorKRr0U6jG/QLBzL4Vd8c2yB6A0Mez9OaZ+Fs1GOWGpy3qnlJiSgJvyE/fzCpPLvfw6e8mbwjhsTlUS2xXe3v1fAMo92MChrb29wTOuyUgqcxOd90teKPSFUCR7Ts9Pr9vKuidc8FL9pKsv/dWwiOtD7Ee+81mGihncvSMHVnrJ4iy+3cnheusNu1Yt8aDvMEA+Q4F/yMgMxBPoW0jp9hTRmalmE/U/cDh8GKBrGqRPFxlUm3SQQXy73Kx/qKtdn2tF3/d+WfJBNIc/jooq4EsLGmX4NwhILzmZHWkc0V86obaXSawjXdgUYbjhZpYg42s7ZEx5BOT41fZYBfBn0GU1O6xl9rFlXFsWhinfOIDODF/rsb73VApu6cQJoXVbTc2SrTQm0jVqqGOGgkjIstb+GkqU/EL3+9z2iDqZg==
    DOMIFA_SMS_API_KEY: >-
      AgB/YosmPprFTFf8R+8ec7RX39d2haOfgjBcLP41jUxYgS5u8zRpVD+F5gLEdDePSxp+1d0BHArJNrTKp2/SJUdiNJr8saTFJ/uBT/KV4fNruKWQFQSMeiP7oqZZiYcxlp52LZXGSDeCWkskGCKhLwfuDZWcgPWAWy4KyI3dsxO9buaosBVycb0Fv2JuPZyphLgV6Xli7AFYaJXXud8tx+0MFi9uAPlSIaEX8oSi6kCCaumvxUoAJ4Sy5S/Ze8bIVUm8Zvp6KQ3IRb9PUs/udB0QzfXvAedDKytR2UAiKWHNBzVGGKjH7noCmIpZ68ovOj4ntJcQy41j7tjvBelEMH2xsgX55eOvG/HHj06rjJWO7UyMFfxUhekYBO0J2w/+/o2LVZKyoe7rqJuevgvrKbk+UBYJb6T3vIGni2P2OtiMEeKsfFbRPiHymfsATZgX+mzbFX++ttPG7QOOXyKOuZfqlH8614F2PTYw98BnZOkTBSbzgpayJs/1BdCBkJ+pQIE7Gc7LfZaxda2mZyOiABR3r60jSz3VRx/wfugmZKcsuknRytbkeOLIkaU4/cwxf64+JYL0E6toUaYOkHp/qoWdGdRj9JBGM3qwEU524yaSsgHAxB06rJRgn52RTeHn7zLc1cgaay23un2era38cSKRbuRnw2Qfrmi9uXUPjHvRGikxaSLZytvQmc1BYhsU4r1sOUc43HtlP92k0YC3QzzeVLfOAdbYgA==
  template:
    metadata:
      annotations:
        sealedsecrets.bitnami.com/cluster-wide: 'true'
        kapp.k14s.io/disable-default-ownership-label-rules: ''
        kapp.k14s.io/disable-default-label-scoping-rules: ''
        app.github.com/job: '5678'
        app.github.com/ref: refs/heads/mybranch
        app.github.com/repo: socialgouv/domifa
        app.github.com/run: '1234'
        app.github.com/sha: '0123456'
      name: backend-sealed-secret
      labels:
        application: domifa
        component: domifa
        owner: domifa
        team: domifa
        cert: wildcard
    type: Opaque
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: backend-configmap
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    application: domifa
    component: domifa
    owner: domifa
    team: domifa
    cert: wildcard
  namespace: domifa-mybranch
data:
  DOMIFA_ENV_ID: k8s-dev
  DOMIFA_ENV_PRESET: dist.preset.env
  PGSSLMODE: require
  NODE_ENV: production
  DOMIFA_PRINT_CONFIG: 'true'
  DOMIFA_TYPEORM_CREATE_DATABASE: 'true'
  DOMIFA_EMAILS_ENABLE: 'true'
  DOMIFA_SMS_ENABLED: 'false'
  POSTGRES_LOGGING: schema,migration
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: backend
    application: domifa
    component: domifa
    owner: domifa
    team: domifa
    cert: wildcard
  name: backend
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  namespace: domifa-mybranch
spec:
  ports:
    - name: http
      port: 80
      targetPort: 3000
  selector:
    app: backend
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: backend
    application: domifa
    component: domifa
    owner: domifa
    team: domifa
    cert: wildcard
  name: backend
  namespace: domifa-mybranch
spec:
  rules:
    - host: domifa-api-domifa-mybranch.dev2.fabrique.social.gouv.fr
      http:
        paths:
          - backend:
              service:
                name: backend
                port:
                  name: http
            path: /
            pathType: Prefix
  tls:
    - hosts:
        - domifa-api-domifa-mybranch.dev2.fabrique.social.gouv.fr
      secretName: wildcard-crt
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: frontend
    application: domifa
    component: nginx
    owner: domifa
    team: domifa
    cert: wildcard
  name: frontend
  namespace: domifa-mybranch
spec:
  replicas: 1
  selector:
    matchLabels:
      app: frontend
  template:
    metadata:
      annotations:
        kapp.k14s.io/disable-default-ownership-label-rules: ''
        kapp.k14s.io/disable-default-label-scoping-rules: ''
        app.github.com/job: '5678'
        app.github.com/ref: refs/heads/mybranch
        app.github.com/repo: socialgouv/domifa
        app.github.com/run: '1234'
        app.github.com/sha: '0123456'
      labels:
        app: frontend
        application: domifa
        component: nginx
        owner: domifa
        team: domifa
        cert: wildcard
    spec:
      containers:
        - image: >-
            ghcr.io/socialgouv/domifa/frontend:sha-9e3027bc7c6dab66be874658abdc12c946fd0357
          livenessProbe:
            failureThreshold: 6
            httpGet:
              path: /index.html
              port: http
            initialDelaySeconds: 30
            periodSeconds: 5
            timeoutSeconds: 5
          name: frontend
          ports:
            - containerPort: 80
              name: http
          readinessProbe:
            failureThreshold: 15
            httpGet:
              path: /index.html
              port: http
            initialDelaySeconds: 0
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 128Mi
            requests:
              cpu: 5m
              memory: 32Mi
          startupProbe:
            failureThreshold: 12
            httpGet:
              path: /index.html
              port: http
            periodSeconds: 5
          env:
            - name: DOMIFA_BACKEND_URL
              value: https://domifa-api-domifa-mybranch.dev2.fabrique.social.gouv.fr/
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: frontend
    application: domifa
    component: nginx
    owner: domifa
    team: domifa
    cert: wildcard
  name: frontend
  annotations:
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  namespace: domifa-mybranch
spec:
  ports:
    - name: http
      port: 80
      targetPort: 80
  selector:
    app: frontend
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    kapp.k14s.io/disable-default-ownership-label-rules: ''
    kapp.k14s.io/disable-default-label-scoping-rules: ''
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    app: frontend
    application: domifa
    component: nginx
    owner: domifa
    team: domifa
    cert: wildcard
  name: frontend
  namespace: domifa-mybranch
spec:
  rules:
    - host: domifa-mybranch.dev2.fabrique.social.gouv.fr
      http:
        paths:
          - backend:
              service:
                name: frontend
                port:
                  name: http
            path: /
            pathType: Prefix
  tls:
    - hosts:
        - domifa-mybranch.dev2.fabrique.social.gouv.fr
      secretName: wildcard-crt
---
apiVersion: batch/v1
kind: Job
spec:
  backoffLimit: 5
  template:
    spec:
      containers:
        - command:
            - create-db-user
          env:
            - name: NEW_DB_NAME
              value: autodevops_mybranch
            - name: NEW_USER
              value: user_mybranch
            - name: NEW_PASSWORD
              value: password_mybranch
            - name: NEW_DB_EXTENSIONS
              value: hstore pgcrypto citext uuid-ossp
          envFrom:
            - secretRef:
                name: azure-pg-admin-user
          image: ghcr.io/socialgouv/docker/azure-db:6.45.0
          imagePullPolicy: IfNotPresent
          name: create-db-user
          resources:
            limits:
              cpu: 300m
              memory: 256Mi
            requests:
              cpu: 100m
              memory: 64Mi
      restartPolicy: Never
  ttlSecondsAfterFinished: 86400
metadata:
  annotations:
    kapp.k14s.io/update-strategy: skip
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    application: domifa
    component: domifa
    owner: domifa
    team: domifa
    cert: wildcard
  name: create-db-job-mybranch
  namespace: domifa-mybranch
---
apiVersion: v1
kind: Secret
stringData:
  DATABASE_URL: >-
    postgresql://user_mybranch%40domifadevserver.postgres.database.azure.com:password_mybranch@domifadevserver.postgres.database.azure.com/autodevops_mybranch?sslmode=require
  DB_URI: >-
    postgresql://user_mybranch%40domifadevserver.postgres.database.azure.com:password_mybranch@domifadevserver.postgres.database.azure.com/autodevops_mybranch?sslmode=require
  HASURA_GRAPHQL_DATABASE_URL: >-
    postgresql://user_mybranch%40domifadevserver.postgres.database.azure.com:password_mybranch@domifadevserver.postgres.database.azure.com/autodevops_mybranch?sslmode=require
  PGDATABASE: autodevops_mybranch
  PGHOST: domifadevserver.postgres.database.azure.com
  PGPASSWORD: password_mybranch
  PGRST_DB_URI: >-
    postgresql://user_mybranch%40domifadevserver.postgres.database.azure.com:password_mybranch@domifadevserver.postgres.database.azure.com/autodevops_mybranch?sslmode=require
  PGSSLMODE: require
  PGUSER: user_mybranch@domifadevserver.postgres.database.azure.com
metadata:
  annotations:
    kapp.k14s.io/update-strategy: skip
    app.github.com/job: '5678'
    app.github.com/ref: refs/heads/mybranch
    app.github.com/repo: socialgouv/domifa
    app.github.com/run: '1234'
    app.github.com/sha: '0123456'
  labels:
    application: domifa
    component: domifa
    owner: domifa
    team: domifa
    cert: wildcard
  name: azure-pg-user-mybranch
  namespace: domifa-mybranch
"
`;
